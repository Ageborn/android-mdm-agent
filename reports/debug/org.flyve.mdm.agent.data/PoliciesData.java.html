<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>PoliciesData.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">debugAndroidTest</a> &gt; <a href="index.source.html" class="el_package">org.flyve.mdm.agent.data</a> &gt; <span class="el_source">PoliciesData.java</span></div><h1>PoliciesData.java</h1><pre class="source lang-java linenums">package org.flyve.mdm.agent.data;

/*
 *   Copyright © 2018 Teclib. All rights reserved.
 *
 *   This file is part of flyve-mdm-android
 *
 * flyve-mdm-android is a subproject of Flyve MDM. Flyve MDM is a mobile
 * device management software.
 *
 * Flyve MDM is free software: you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 3
 * of the License, or (at your option) any later version.
 *
 * Flyve MDM is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * ------------------------------------------------------------------------------
 * @author    Rafael Hernandez
 * @date      8/4/18
 * @copyright Copyright © 2018 Teclib. All rights reserved.
 * @license   GPLv3 https://www.gnu.org/licenses/gpl-3.0.html
 * @link      https://github.com/flyve-mdm/flyve-mdm-android
 * @link      https://flyve-mdm.com
 * ------------------------------------------------------------------------------
 */

import android.content.Context;

import org.flyve.inventory.categories.Usb;
import org.flyve.mdm.agent.room.database.AppDataBase;
import org.flyve.mdm.agent.room.entity.Policies;

import java.util.List;

public class PoliciesData {

    private static final String PASSWORD_ENABLED = &quot;passwordEnabled&quot;;
    private static final String PASSWORD_QUALITY = &quot;passwordQuality&quot;;
    private static final String PASSWORD_MINIMUM_LENGTH = &quot;passwordMinimumLength&quot;;
    private static final String PASSWORD_MINIMUM_LOWER_CASE = &quot;passwordMinimumLowerCase&quot;;
    private static final String PASSWORD_MINIMUM_UPPER_CASE = &quot;passwordMinimumUpperCase&quot;;
    private static final String PASSWORD_MINIMUM_NON_LETTER = &quot;passwordMinimumNonLetter&quot;;
    private static final String PASSWORD_MINIMUM_LETTERS = &quot;passwordMinimumLetters&quot;;
    private static final String PASSWORD_MINIMUM_NUMERIC = &quot;passwordMinimumNumeric&quot;;
    private static final String PASSWORD_MINIMUM_SYMBOLS = &quot;passwordMinimumSymbols&quot;;
    private static final String MAXIMUM_FAILED_PASSWORDS_FOR_WIPE = &quot;maximumFailedPasswordsForWipe&quot;;
    private static final String MAXIMUM_TIME_TO_LOCK = &quot;maximumTimeToLock&quot;;
    private static final String STORAGE_ENCRYPTION = &quot;storageEncryption&quot;;
    private static final String DISABLE_CAMERA = &quot;disableCamera&quot;;
    private static final String DISABLE_BLUETOOTH = &quot;disableBluetooth&quot;;
    private static final String DISABLE_SCREEN_CAPTURE = &quot;disableScreenCapture&quot;;
    private static final String DISABLE_AIRPLANE_MODE = &quot;disableAirplaneMode&quot;;
    private static final String DISABLE_GPS = &quot;disableGPS&quot;;
    private static final String DISABLE_HOSTPOT_TETHERING = &quot;disableHostpotTethering&quot;;
    private static final String DISABLE_ROAMING = &quot;disableRoaming&quot;;
    private static final String DISABLE_WIFI = &quot;disableWifi&quot;;
    private static final String USE_TLS = &quot;useTLS&quot;;
    private static final String DISABLE_MOBILE_LINE = &quot;disableMobileLine&quot;;
    private static final String DISABLE_NFC = &quot;disableNFC&quot;;
    private static final String DISABLE_STATUSBAR = &quot;disableStatusbar&quot;;
    private static final String DISABLE_USB_MTP = &quot;disableUsbMtp&quot;;
    private static final String DISABLE_USB_PTP = &quot;disableUsbPtp&quot;;
    private static final String DISABLE_USB_ADB = &quot;disableUsbAdb&quot;;
    private static final String DISABLE_SPEAKER_PHONE = &quot;disableSpeakerphone&quot;;
    private static final String DISABLE_VPN = &quot;disableVPN&quot;;
    private static final String DISABLE_SMS_MMS = &quot;disableSmsMms&quot;;

    private AppDataBase dataBase;

<span class="nc" id="L73">    public PoliciesData(Context context) {</span>
<span class="nc" id="L74">        dataBase = AppDataBase.getAppDatabase(context);</span>
<span class="nc" id="L75">    }</span>

    public boolean getPasswordEnabled() {
<span class="nc" id="L78">        return getBooleanValue(PASSWORD_ENABLED);</span>
    }

    public void setPasswordEnabled(Boolean enable) {
<span class="nc" id="L82">        setBooleanValue(PASSWORD_ENABLED, enable);</span>
<span class="nc" id="L83">    }</span>

    public String getPasswordQuality() {
<span class="nc" id="L86">        return getStringValue(PASSWORD_QUALITY);</span>
    }

    public void setPasswordQuality(String value) {
<span class="nc" id="L90">        setStringValue(PASSWORD_QUALITY, value);</span>
<span class="nc" id="L91">    }</span>

    public int getPasswordMinimumLength() {
<span class="nc" id="L94">        return getIntValue(PASSWORD_MINIMUM_LENGTH);</span>
    }

    public void setPasswordMinimumLength(int value) {
<span class="nc" id="L98">        setIntValue(PASSWORD_MINIMUM_LENGTH, value);</span>
<span class="nc" id="L99">    }</span>

    public int getPasswordMinimumLowerCase() {
<span class="nc" id="L102">        return getIntValue(PASSWORD_MINIMUM_LOWER_CASE);</span>
    }

    public void setPasswordMinimumLowerCase(int value) {
<span class="nc" id="L106">        setIntValue(PASSWORD_MINIMUM_LOWER_CASE, value);</span>
<span class="nc" id="L107">    }</span>

    public int getPasswordMinimumUpperCase() {
<span class="nc" id="L110">        return getIntValue(PASSWORD_MINIMUM_UPPER_CASE);</span>
    }

    public void setPasswordMinimumUpperCase(int value) {
<span class="nc" id="L114">        setIntValue(PASSWORD_MINIMUM_UPPER_CASE, value);</span>
<span class="nc" id="L115">    }</span>

    public int getPasswordMinimumNonLetter() {
<span class="nc" id="L118">        return getIntValue(PASSWORD_MINIMUM_NON_LETTER);</span>
    }

    public void setPasswordMinimumNonLetter(int value) {
<span class="nc" id="L122">        setIntValue(PASSWORD_MINIMUM_NON_LETTER, value);</span>
<span class="nc" id="L123">    }</span>

    public int getPasswordMinimumLetters() {
<span class="nc" id="L126">        return getIntValue(PASSWORD_MINIMUM_LETTERS);</span>
    }

    public void setPasswordMinimumLetters(int value) {
<span class="nc" id="L130">        setIntValue(PASSWORD_MINIMUM_LETTERS, value);</span>
<span class="nc" id="L131">    }</span>

    public int getPasswordMinimumNumeric() {
<span class="nc" id="L134">        return getIntValue(PASSWORD_MINIMUM_NUMERIC);</span>
    }

    public void setPasswordMinimumNumeric(int value) {
<span class="nc" id="L138">        setIntValue(PASSWORD_MINIMUM_NUMERIC, value);</span>
<span class="nc" id="L139">    }</span>

    public int getPasswordMinimumSymbols() {
<span class="nc" id="L142">        return getIntValue(PASSWORD_MINIMUM_SYMBOLS);</span>
    }

    public void setPasswordMinimumSymbols(int value) {
<span class="nc" id="L146">        setIntValue(PASSWORD_MINIMUM_SYMBOLS, value);</span>
<span class="nc" id="L147">    }</span>

    public int getMaximumFailedPasswordsForWipe() {
<span class="nc" id="L150">        return getIntValue(MAXIMUM_FAILED_PASSWORDS_FOR_WIPE);</span>
    }

    public void setMaximumFailedPasswordsForWipe(int value) {
<span class="nc" id="L154">        setIntValue(MAXIMUM_FAILED_PASSWORDS_FOR_WIPE, value);</span>
<span class="nc" id="L155">    }</span>

    public int getMaximumTimeToLock() {
<span class="nc" id="L158">        return getIntValue(MAXIMUM_TIME_TO_LOCK);</span>
    }

    public void setMaximumTimeToLock(int value) {
<span class="nc" id="L162">        setIntValue(MAXIMUM_TIME_TO_LOCK, value);</span>
<span class="nc" id="L163">    }</span>

    public boolean getStorageEncryption() {
<span class="nc" id="L166">        return getBooleanValue(STORAGE_ENCRYPTION);</span>
    }

    public void setStorageEncryption(boolean value) {
<span class="nc" id="L170">        setBooleanValue(STORAGE_ENCRYPTION, value);</span>
<span class="nc" id="L171">    }</span>

    public boolean getDisableCamera() {
<span class="nc" id="L174">        return getBooleanValue(DISABLE_CAMERA);</span>
    }

    public void setDisableCamera(boolean value) {
<span class="nc" id="L178">        setBooleanValue(DISABLE_CAMERA, value);</span>
<span class="nc" id="L179">    }</span>

    public boolean getDisableBluetooth() {
<span class="nc" id="L182">        return getBooleanValue(DISABLE_BLUETOOTH);</span>
    }

    public void setDisableBluetooth(boolean value) {
<span class="nc" id="L186">        setBooleanValue(DISABLE_BLUETOOTH, value);</span>
<span class="nc" id="L187">    }</span>

    public boolean getDisableScreenCapture() {
<span class="nc" id="L190">        return getBooleanValue(DISABLE_SCREEN_CAPTURE);</span>
    }

    public void setDisableScreenCapture(boolean value) {
<span class="nc" id="L194">        setBooleanValue(DISABLE_SCREEN_CAPTURE, value);</span>
<span class="nc" id="L195">    }</span>

    public boolean getDisableAirplaneMode() {
<span class="nc" id="L198">        return getBooleanValue(DISABLE_AIRPLANE_MODE);</span>
    }

    public void setDisableAirplaneMode(boolean value) {
<span class="nc" id="L202">        setBooleanValue(DISABLE_AIRPLANE_MODE, value);</span>
<span class="nc" id="L203">    }</span>

    public boolean getDisableGPS() {
<span class="nc" id="L206">        return getBooleanValue(DISABLE_GPS);</span>
    }

    public void setDisableGPS(boolean value) {
<span class="nc" id="L210">        setBooleanValue(DISABLE_GPS, value);</span>
<span class="nc" id="L211">    }</span>

    public boolean getDisableHostpotTethering() {
<span class="nc" id="L214">        return getBooleanValue(DISABLE_HOSTPOT_TETHERING);</span>
    }

    public void setDisableHostpotTethering(boolean value) {
<span class="nc" id="L218">        setBooleanValue(DISABLE_HOSTPOT_TETHERING, value);</span>
<span class="nc" id="L219">    }</span>

    public boolean getDisableRoaming() {
<span class="nc" id="L222">        return getBooleanValue(DISABLE_ROAMING);</span>
    }

    public void setDisableRoaming(boolean value) {
<span class="nc" id="L226">        setBooleanValue(DISABLE_ROAMING, value);</span>
<span class="nc" id="L227">    }</span>

    public boolean getDisableWifi() {
<span class="nc" id="L230">        return getBooleanValue(DISABLE_WIFI);</span>
    }

    public void setDisableWifi(boolean value) {
<span class="nc" id="L234">        setBooleanValue(DISABLE_WIFI, value);</span>
<span class="nc" id="L235">    }</span>

    public boolean getUseTLS() {
<span class="nc" id="L238">        return getBooleanValue(USE_TLS);</span>
    }

    public void setUseTLS(boolean value) {
<span class="nc" id="L242">        setBooleanValue(USE_TLS, value);</span>
<span class="nc" id="L243">    }</span>

    public boolean getDisableMobileLine() {
<span class="nc" id="L246">        return getBooleanValue(DISABLE_MOBILE_LINE);</span>
    }

    public void setDisableMobileLine(boolean value) {
<span class="nc" id="L250">        setBooleanValue(DISABLE_MOBILE_LINE, value);</span>
<span class="nc" id="L251">    }</span>

    public boolean getDisableNFC() {
<span class="nc" id="L254">        return getBooleanValue(DISABLE_NFC);</span>
    }

    public void setDisableNFC(boolean value) {
<span class="nc" id="L258">        setBooleanValue(DISABLE_NFC, value);</span>
<span class="nc" id="L259">    }</span>

    public boolean getDisableStatusbar() {
<span class="nc" id="L262">        return getBooleanValue(DISABLE_STATUSBAR);</span>
    }

    public void setDisableStatusbar(boolean value) {
<span class="nc" id="L266">        setBooleanValue(DISABLE_STATUSBAR, value);</span>
<span class="nc" id="L267">    }</span>

    public boolean getDisableUsbMtp() {
<span class="nc" id="L270">        return getBooleanValue(DISABLE_USB_MTP);</span>
    }

    public void setDisableUsbMtp(boolean value) {
<span class="nc" id="L274">        setBooleanValue(DISABLE_USB_MTP, value);</span>
<span class="nc" id="L275">    }</span>

    public boolean getDisableUsbPtp() {
<span class="nc" id="L278">        return getBooleanValue(DISABLE_USB_PTP);</span>
    }

    public void setDisableUsbPtp(boolean value) {
<span class="nc" id="L282">        setBooleanValue(DISABLE_USB_PTP, value);</span>
<span class="nc" id="L283">    }</span>

    public boolean getDisableUsbAdb() {
<span class="nc" id="L286">        return getBooleanValue(DISABLE_USB_ADB);</span>
    }

    public void setDisableUsbAdb(boolean value) {
<span class="nc" id="L290">        setBooleanValue(DISABLE_USB_ADB, value);</span>
<span class="nc" id="L291">    }</span>

    public boolean getDisableSpeakerphone() {
<span class="nc" id="L294">        return getBooleanValue(DISABLE_SPEAKER_PHONE);</span>
    }

    public void setDisableSpeakerphone(boolean value) {
<span class="nc" id="L298">        setBooleanValue(DISABLE_SPEAKER_PHONE, value);</span>
<span class="nc" id="L299">    }</span>

    public boolean getDisableVPN() {
<span class="nc" id="L302">        return getBooleanValue(DISABLE_VPN);</span>
    }

    public void setDisableVPN(boolean value) {
<span class="nc" id="L306">        setBooleanValue(DISABLE_VPN, value);</span>
<span class="nc" id="L307">    }</span>

    public boolean getDisableSmsMms() {
<span class="nc" id="L310">        return getBooleanValue(DISABLE_SMS_MMS);</span>
    }

    public void setDisableSmsMms(boolean value) {
<span class="nc" id="L314">        setBooleanValue(DISABLE_SMS_MMS, value);</span>
<span class="nc" id="L315">    }</span>

    private String getStringValue(String policyName) {
<span class="nc" id="L318">        List&lt;Policies&gt; arrPolicies = dataBase.PoliciesDao().getByPolicyName(policyName);</span>
<span class="nc bnc" id="L319" title="All 2 branches missed.">        if(!arrPolicies.isEmpty()) {</span>
<span class="nc" id="L320">            return arrPolicies.get(0).value;</span>
        } else {
<span class="nc" id="L322">            return &quot;&quot;;</span>
        }
    }

    private void setStringValue(String policyName, String value) {
<span class="nc bnc" id="L327" title="All 2 branches missed.">        if(dataBase.PoliciesDao().getByPolicyName(policyName).isEmpty()) {</span>
<span class="nc" id="L328">            Policies policies = new Policies();</span>
<span class="nc" id="L329">            policies.policyName = policyName;</span>
<span class="nc" id="L330">            policies.value = value;</span>
<span class="nc" id="L331">            dataBase.PoliciesDao().insert(policies);</span>
<span class="nc" id="L332">        } else {</span>
<span class="nc" id="L333">            Policies policies = dataBase.PoliciesDao().getByPolicyName(policyName).get(0);</span>
<span class="nc" id="L334">            policies.value = value;</span>
<span class="nc" id="L335">            dataBase.PoliciesDao().update(policies);</span>
        }
<span class="nc" id="L337">    }</span>

    private boolean getBooleanValue(String policyName) {
<span class="nc" id="L340">        String value = getStringValue(policyName);</span>
<span class="nc bnc" id="L341" title="All 2 branches missed.">        if(value.equals(&quot;&quot;)) {</span>
<span class="nc" id="L342">            value = &quot;false&quot;;</span>
        }
<span class="nc" id="L344">        return Boolean.valueOf(value);</span>
    }

    private void setBooleanValue(String policyName, Boolean enable) {
<span class="nc" id="L348">        setStringValue(policyName, String.valueOf(enable));</span>
<span class="nc" id="L349">    }</span>

    private int getIntValue(String policyName) {
<span class="nc" id="L352">        String value = getStringValue(policyName);</span>
<span class="nc bnc" id="L353" title="All 2 branches missed.">        if(value.equals(&quot;&quot;)) {</span>
<span class="nc" id="L354">            value = &quot;0&quot;;</span>
        }
<span class="nc" id="L356">        return Integer.parseInt(value);</span>
    }

    private void setIntValue(String policyName, int value) {
<span class="nc" id="L360">        setStringValue(policyName, String.valueOf(value));</span>
<span class="nc" id="L361">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.4.201502262128</span>Generated by the Android Gradle plugin 3.0.1</div></body></html>